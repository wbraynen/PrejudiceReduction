<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prejudice Reduction: Spatialized Game Theory Model</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20enegro;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: bold;
            color: #34495e;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        select, input[type="range"], input[type="number"] {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            font-size: 14px;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        #startBtn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        #pauseBtn {
            background: #f39c12;
            color: white;
        }
        
        #resetBtn {
            background: #e74c3c;
            color: white;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .canvas-container {
            background: white;
            border: 3px solid #ecf0f1;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        canvas {
            display: block;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            width: 100%;
            height: auto;
        }
        
        .canvas-title {
            text-align: center;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .stats {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        #chart {
            height: 300px;
            background: white;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            padding: 20px;
            position: relative;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            justify-content: center;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9em;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        
        .info-panel {
            background: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        .info-panel h3 {
            color: #2980b9;
            margin-top: 0;
        }
        
        .slider-value {
            display: inline-block;
            width: 40px;
            text-align: right;
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Modeling Prejudice Reduction</h1>
        <div class="subtitle">Spatialized Game Theory and the Contact Hypothesis</div>
        
        <div class="controls">
            <div class="control-group">
                <label for="environment">Environment Type:</label>
                <select id="environment">
                    <option value="segregated">Segregated (Non-Contact)</option>
                    <option value="mixed">Mixed (Contact)</option>
                    <option value="checkerboard">Checkerboard (Maximum Contact)</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="gridSize">Grid Size:</label>
                <select id="gridSize">
                    <option value="32">32x32</option>
                    <option value="64" selected>64x64</option>
                    <option value="128">128x128</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="speed">Simulation Speed: <span class="slider-value" id="speedValue">100</span>ms</label>
                <input type="range" id="speed" min="50" max="1000" value="100" step="50">
            </div>
            
            <div class="control-group">
                <label for="socialBonus">Social ID Bonus for PTFT: <span class="slider-value" id="bonusValue">0</span></label>
                <input type="range" id="socialBonus" min="0" max="5" value="0">
            </div>
        </div>
        
        <div class="button-group">
            <button id="startBtn">Start Simulation</button>
            <button id="pauseBtn">Pause</button>
            <button id="resetBtn">Reset</button>
        </div>
        
        <div class="stats">
            <div class="stat-grid">
                <div class="stat-item">
                    <div class="stat-label">Generation</div>
                    <div class="stat-value" id="generation">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">TFT Coverage</div>
                    <div class="stat-value" id="tftPercent">0%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">PTFT Coverage</div>
                    <div class="stat-value" id="ptftPercent">0%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">All-D Coverage</div>
                    <div class="stat-value" id="allDPercent">0%</div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="canvas-container">
                <div class="canvas-title">Strategy Distribution</div>
                <canvas id="strategyCanvas"></canvas>
            </div>
            <div class="canvas-container">
                <div class="canvas-title">Group Distribution (Red/Green)</div>
                <canvas id="colorCanvas"></canvas>
            </div>
        </div>
        
        <div id="chart">
            <canvas id="chartCanvas"></canvas>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #000000;"></div>
                <span>TFT (Tit for Tat)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FF4444;"></div>
                <span>PTFT (Prejudicial TFT)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4444FF;"></div>
                <span>All-Defect</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #44FF44;"></div>
                <span>All-Cooperate</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FF44FF;"></div>
                <span>C-then-All-D</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #FFFF44;"></div>
                <span>Suspicious TFT</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #44FFFF;"></div>
                <span>Perverse</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #888888;"></div>
                <span>Other Strategies</span>
            </div>
        </div>
        
        <div class="info-panel">
            <h3>About the Model</h3>
            <p>This simulation demonstrates the contact hypothesis through spatialized game theory. Agents play the Prisoner's Dilemma with their neighbors, adopting successful strategies. In segregated environments, prejudicial strategies (PTFT) can thrive, but in mixed environments, color-blind cooperation (TFT) dominates.</p>
        </div>
    </div>
    
    <script src="model.js" defer></script>
</body>
</html>